ğŸ“šâ€¯Spinâ€¯Analyzer â€“ â€œGuiaÂ Primeâ€
Manual completo para transformar XMLâ€¯iPoker âœâ€¯dataset analÃ­tico âœâ€¯modelo que entende o â€œraciocÃ­nio streetâ€‘aâ€‘streetâ€ do jogador

Ãndice
Objetivo & VisÃ£o de Produto

GlossÃ¡rio de Termos de Poker & Analytics

Arquitetura de DiretÃ³rios & Ambiente

Pipeline ETL â€“ VisÃ£o de AltoÂ NÃ­vel

Esquema de Dados (Tabelas)

Camada de Features

VectorizaÃ§Ã£o & Modelagem

Roadâ€‘map de ExecuÃ§Ã£o

Boas PrÃ¡ticas, Armadilhas & FAQ

<a id="1"></a>

1â€¯â–ªâ€¯Objetivo & VisÃ£o
MissÃ£o: criar um pipeline que lÃª histÃ³ricos brutos, reconstrÃ³i cada decisÃ£o com contexto total (stack, pot, textura) e treina um modelo Transformer que antecipa a prÃ³xima aÃ§Ã£o do hero ou classifica padrÃµes de um vilÃ£o.

Valor entregue:

Stakeholder	Ganho
Jogador	RelatÃ³rios de leaks, perfis de oponentes, â€œcoachâ€ automÃ¡tico
Analista	Dataset limpo, queryâ€‘able, pronto para dashboards
Dataâ€‘Scientist	Pipelines reproduzÃ­veis +Â features densas

<a id="2"></a>

2â€¯â–ªâ€¯GlossÃ¡rio Essencial
Termo	DefiniÃ§Ã£o curta	ImportÃ¢ncia para features
SPR (Stackâ€‘toâ€‘PotÂ Ratio)	eff_stack / pot no inÃ­cio da street	Define agressividade Ã³tima
Board Texture	â€œSecoâ€ (Aâ€‘7â€‘2Â rainbow) vs â€œmolhadoâ€ (Jâ€‘Tâ€‘9â€¯â™¥â™ â™¥)	Conduz câ€‘bet size, checkâ€‘raise freq
Made Class	Categoria de mÃ£o (topÂ pair, straightâ€¦)	RÃ³tulo alvo p/ bluffâ€¯vsâ€¯value
Draw Class	Type of draw (flush, gutshot, combo)	Determina equity & semiâ€‘bluff spots
Position	IP (inâ€‘position) ou OOP (outâ€‘ofâ€‘position)	Fator crÃ­tico de range & size
Action Encoding	BET_33, BET_66, JAMâ€¦ (padronizado)	Token para modelo prever
Hero/VilÃ£o	Foco da prediÃ§Ã£o (hero) vs oponentes	NecessÃ¡rio p/ rÃ³tulos corretos
PHH	Pokerâ€‘Handâ€‘History unificado (phhâ€‘std)	Fonte canÃ´nica depois do parsing

<a id="3"></a>

3â€¯â–ªâ€¯Arquitetura de DiretÃ³rios & Ambiente
bash
Copiar
Editar
spinAnalyzer/
â”œâ”€ .venv/               # PythonÂ 3.11 venv
â”œâ”€ pokerkit/            # repo editable
â”œâ”€ phh-std/             # repo editable
â”œâ”€ dataset/
â”‚   â”œâ”€ original_hands/ipoker/*.xml
â”‚   â”œâ”€ phh/*.phh               â† ETAPAÂ A
â”‚   â”œâ”€ actions/*.parquet       â† ETAPAÂ B1
â”‚   â”œâ”€ street_features/*.parquet â† ETAPAÂ B2
â”‚   â””â”€ vectors/*.npy           â† ETAPAÂ C
â””â”€ notebooks/
    â”œâ”€ 01_xml_to_phh.ipynb
    â”œâ”€ 02_phh_to_features.ipynb
    â””â”€ 03_train_transformer.ipynb
Kernel Jupyter: Python (spinAnalyzer)
Bootstrap pronto: instala PythonÂ 3.11, cria venv, registra kernel, clona libs.

<a id="4"></a>

4â€¯â–ªâ€¯Pipeline ETL
Fase	Script/Notebook	Input âœÂ Output	Toolâ€‘core
A. Parsing	01_xml_to_phh.ipynb	XML âœÂ PHH	phhâ€‘std
B1. AÃ§Ãµes	02_phh_to_features.ipynb (parteÂ 1)	PHH âœÂ t_actions.parquet	PokerKit
B2. Street Feats	02_phh_to_features.ipynb (parteÂ 2)	PHH âœÂ t_street_features.parquet	PokerKit + calc. prÃ³prias
C. VectorizaÃ§Ã£o	03_train_transformer.ipynb	Parquet âœÂ .npy / .pt	pandasÂ / NumPy
D. Treino	(mesmo 03)	vetores âœÂ model.ckpt	PyTorchÂ / HF Transformers

<a id="5"></a>

5â€¯â–ªâ€¯Esquema de Dados
5.1â€¯hands (granularidade: 1Â mÃ£o)
col	dtype	origem	descriÃ§Ã£o
hand_id	int64	PHH tag	Ãºnico
session_id	int64	XML	p/ juntar multiâ€‘table
date_utc	ts	XML	inÃ­cio
table_name	str	XML	
stakes	str	â€œâ‚¬0.05/â‚¬0.10â€	
ante_bb	float	calc	ante / BB
players	json	PHH	lista de {seat, name, stack0}
hero_name	str	config	
winner_names	list	PHH	

5.2â€¯actions (1Â linhaâ€¯=â€¯1Â aÃ§Ã£o)
col	dtype	notas
hand_id, step_idx	PK	
player_seat / name	â€¦	
street	ENUM {PREFLOP,FLOP,TURN,RIVER}	
action_type	RAISE, CALL, POST_SBâ€¦	
amount_bb	float	
pot_bb_before	float	
eff_stack_bb_before	float	
board_cards	str	
hole_cards_known	str / NULL	

5.3â€¯street_features (1Â linhaâ€¯=â€¯(hero, street))
col	exemplo
hand_id, street, hero_pos	123, FLOP, BTN
hero_cards	['9h','7h']
board_cards	['Th','8h','3c']
board_class	WET / DRY / PAIREDâ€¦
fd_flag	1/0
sd_type	GUTSHOT / OPEN_END /
combo_draw_flag	1
made_class	NO_PAIR / TOP_PAIR / FLUSHâ€¦
spr_bucket	LOW / MED / HIGH
pot_size	7.5bb
action_taken	BET_66 / X / XRâ€¦
result_showdown	WIN / LOSE / NA
equity_vs_random	0.38
villain_aggr_line	XRâœ“ / c/c

5.4â€¯player_stats (agg por jogador)
col	descriÃ§Ã£o
vpip, pfr, 3bet_pct	contagem a partir de actions
cbet_flop_pct, fold2cbet	â€¦
payoff_mean, payoff_std	ganhos em bb
hands_sampled	densidade

<a id="6"></a>

6â€¯â–ªâ€¯Features Detalhadas
Categoria	Campo	Como obter
Boardâ€‘texture	paired_board, monotone, connectedness_idx	heurÃ­stica sobre board_cards
Draws	fd_flag, sd_type, combo_draw_flag	PokerKitÂ â†’ outsÂ / flushâ€‘draw
Made	made_class	Hand.strength() (highâ€¯card, pair, â€¦)
SPR/Pot	spr, pot_size	via GameState
PosiÃ§Ã£o	hero_pos, in_position_bool	assento relativo ao botÃ£o
Linha Anterior	prev_aggr_line_code	string compacta de aÃ§Ãµes
Equity	equity_vs_range	Monteâ€‘Carlo 1â€¯k iters (opcional)
Outcome	result_showdown, pot_won_bb	final da mÃ£o

Buckets (ex.: spr_bucket) sÃ£o mapeados por corte: LOWÂ <â€¯2, MEDâ€¯2â€‘6,Â HIGHâ€¯>â€¯6.

<a id="7"></a>

7â€¯â–ªâ€¯VectorizaÃ§Ã£o & Modelo
VocabulÃ¡rio

Tokens para aÃ§Ãµes (BET_33, BET_66, JAM, X)

Tokens para features discretas (POS_BTN, SPR_LOW, BOARD_WET).

[<CLS>, <SEP>, <MASK>]

SequÃªncia

text
Copiar
Editar
<CLS> PREFLOP  ...  <SEP>  FLOP  ...  <SEP>  TURN ...
step_idx vira posiÃ§Ã£o absoluta.

Embedding

Discretos â†’ nn.Embedding.

Valores contÃ­nuos â†’ LayerNorm(Linear(x)).

CabeÃ§ote de saÃ­da

MLM: softmax sobre vocabulÃ¡rio de aÃ§Ãµes.

ou tripla regressÃ£o (size, action_type, fold_flag).

<a id="8"></a>

8â€¯â–ªâ€¯Roadâ€‘map (Sâ€‘prints)
Semana	Meta tangÃ­vel
S1	Parser XMLÂ â†’Â PHH 100â€¯% mÃ£os â€¢ unitâ€‘tests
S2	GameState builder + cÃ¡lculo de SPR & texture
S3	t_actions & t_street_features Parquet, 50â€¯kÂ linhas
S4	Tokenizer + baseline BERTâ€‘tiny, treinar 10â€¯epochs
S5	Dash â€œHero leak finderâ€ (câ€‘bet, 3â€‘bet freq)
S6+	Hiperparam tuning, equity features, clusterizaÃ§Ã£o vilÃµes

<a id="9"></a>

9â€¯â–ªâ€¯Boas PrÃ¡ticas & Armadilhas
âœ”â€¯FAÃ‡A	âœ–â€¯NÃƒO FAÃ‡A
Versione datasets com DuckDBÂ +Â _vYYYYMMDD	Salvar CSV gigantes (I/O lento)
Use Monteâ€‘Carlo equity apenas para flop/turn	Rodar 1â€¯k sims para cada decisÃ£o (custo)
Verifique stack e pot apÃ³s cada aÃ§Ã£o (bug catch)	Assumir que amount_bb estÃ¡ sempre certo
Separe â€œtreino/valâ€ por sessÃ£o (nÃ£o por mÃ£o)	Vazamento temporal
Armazene PHH cru para auditoria	Sobrescrever XML fonte
Logue hash do PHH na tabela features	Perder rastreabilidade